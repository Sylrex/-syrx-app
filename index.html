<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYRX Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .page {
            display: none;
        }
        .active {
            display: block;
        }
        .logo {
            font-size: 48px;
            color: #007bff;
            margin-bottom: 20px;
        }
        .user-photo {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 10px;
        }
        button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #218838;
        }
        .nav-buttons {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: #fff;
            padding: 10px;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around;
        }
        .leaderboard {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }
        .leaderboard-item {
            background: #fff;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="home" class="page active">
        <div class="logo">SYRX</div>
        <img id="user-photo" class="user-photo" src="" alt="User Photo">
        <h2 id="user-name">Welcome!</h2>
        <p>Your points: <span id="points">0</span></p>
    </div>

    <div id="tasks" class="page">
        <h2>Tasks</h2>
        <button onclick="openLink('https://x.com/SylrexOfficial?t=xMY6eEauM0DXY5VllXdT-w&s=09')">Follow X Account</button>
        <button onclick="openLink('https://www.facebook.com/share/1JYzm6CGsS/')">Follow Facebook</button>
        <button onclick="openLink('https://www.youtube.com/@SylrexOfficial')">Follow YouTube 1</button>
        <button onclick="openLink('https://www.youtube.com/@Sylrex_Official')">Follow YouTube 2</button>
        <button id="daily-login">Daily Login ( +10 points )</button>
        <button id="connect-wallet">Connect TON Wallet</button>
        <p>Wallet Status: <span id="wallet-status">Not Connected</span></p>
    </div>

    <div id="referrals" class="page">
        <h2>Referrals</h2>
        <p>Your Referral Link: <span id="ref-link">Generating...</span></p>
        <button onclick="shareRefLink()">Share Link</button>
        <h3>Top 100 Leaderboard</h3>
        <div class="leaderboard" id="leaderboard"></div>
    </div>

    <div class="nav-buttons">
        <button onclick="showPage('home')">Home</button>
        <button onclick="showPage('tasks')">Tasks</button>
        <button onclick="showPage('referrals')">Referrals</button>
    </div>

    <script>
        const WebApp = window.Telegram.WebApp;
        WebApp.ready();

        const user = WebApp.initDataUnsafe.user;
        if (user) {
            document.getElementById('user-name').innerText = `Welcome, ${user.first_name || 'User'}!`;
            if (user.photo_url) {
                document.getElementById('user-photo').src = user.photo_url;
            }
        }

        // Theme for attractive colors
        const theme = WebApp.themeParams;
        document.body.style.backgroundColor = theme.bg_color || '#f0f4f8';
        document.body.style.color = theme.text_color || '#333';

        // Points mock (use localStorage)
        let points = localStorage.getItem('points') || 0;
        document.getElementById('points').innerText = points;

        // Daily Login
        const dailyLoginBtn = document.getElementById('daily-login');
        const lastLogin = localStorage.getItem('lastLogin');
        const today = new Date().toDateString();
        if (lastLogin === today) {
            dailyLoginBtn.disabled = true;
            dailyLoginBtn.innerText = 'Already Logged In Today';
        }
        dailyLoginBtn.onclick = () => {
            points = parseInt(points) + 10;
            localStorage.setItem('points', points);
            localStorage.setItem('lastLogin', today);
            document.getElementById('points').innerText = points;
            dailyLoginBtn.disabled = true;
            dailyLoginBtn.innerText = 'Already Logged In Today';
            alert(' +10 points added!');
        };

        // TON Wallet Connection
        const connector = new TonConnectSDK.TonConnect();
        const walletStatus = document.getElementById('wallet-status');
        const connectBtn = document.getElementById('connect-wallet');

        connector.onStatusChange(walletInfo => {
            if (walletInfo) {
                walletStatus.innerText = 'Connected: ' + walletInfo.account.address;
                connectBtn.innerText = 'Disconnect Wallet';
                connectBtn.onclick = () => connector.disconnect();
            } else {
                walletStatus.innerText = 'Not Connected';
                connectBtn.innerText = 'Connect TON Wallet';
                connectBtn.onclick = connectWallet;
            }
        });

        async function connectWallet() {
            const wallets = await connector.getWallets();
            // For simplicity, connect to first wallet (e.g., Tonkeeper)
            const link = connector.connect({ jsBridgeKey: 'tonkeeper' }); // Adjust for other wallets
            WebApp.openLink(link); // Open in Telegram
        }
        connectBtn.onclick = connectWallet;

        // Open Links
        function openLink(url) {
            WebApp.openLink(url);
            // Add points mock for completing task
            points = parseInt(points) + 5;
            localStorage.setItem('points', points);
            document.getElementById('points').innerText = points;
            alert('Task completed! +5 points');
        }

        // Referral System
        const refLinkElem = document.getElementById('ref-link');
        const botUsername = '@SYRXApp_bot'; // Replace with your bot's username
        const refLink = `https://t.me/${botUsername}?start=ref_${user ? user.id : 'guest'}`;
        refLinkElem.innerText = refLink;

        function shareRefLink() {
            WebApp.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(refLink)}&text=Join SYRX and earn points!`);
        }

        // Leaderboard Mock (Top 100 by points)
        const leaderboard = document.getElementById('leaderboard');
        for (let i = 1; i <= 100; i++) {
            const item = document.createElement('div');
            item.className = 'leaderboard-item';
            item.innerText = `#${i} User${i} - ${1000 - i * 10} points`;
            leaderboard.appendChild(item);
        }

        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
        }
    </script>
</body>
</html>
